{
  "Comment": "Instances-SetupSSHKey-v1_0_0",
  "StartAt": "ChooseEventType",
  "States": {
    "ChooseEventType": {
      "Type": "Choice",
      "Choices": [
        {
          "Variable": "$.RequestType",
          "StringEquals": "Create",
          "Next": "SetCreateSSHKey"
        },
        {
          "Variable": "$.RequestType",
          "StringEquals": "Update",
          "Next": "CreateSSHKey"
        },
        {
          "Variable": "$.RequestType",
          "StringEquals": "Delete",
          "Next": "DeleteSSHKey"
        }
      ],
      "Default": "Fail"
    },
    "SetCreateSSHKey": {
      "Type": "Pass",
      "ResultPath": "$.createSSHKey",
      "Result": true,
      "Next": "DeleteSSHKey"
    },
    "DeleteSSHKey": {
      "Type": "Task",
      "ResultPath": null,
      "Resource": "function:DeleteSSHKey",
      "Next": "CheckCreateSSHKey",
      "Catch": [{
        "ErrorEquals": [ "States.ALL" ],
        "ResultPath": null,
        "Next": "Fail"
      }]
    },
    "CheckCreateSSHKey": {
      "Type": "Choice",
      "Choices": [
        {
          "Variable": "$.createSSHKey",
          "BooleanEquals": true,
          "Next": "CreateSSHKey"
        }
      ],
      "Default": "Succeed"
    },
    "CreateSSHKey": {
      "Type": "Task",
      "ResultPath": null,
      "Resource": "function:CreateSSHKey",
      "Next": "Succeed",
      "Catch": [{
        "ErrorEquals": [ "States.ALL" ],
        "ResultPath": null,
        "Next": "Fail"
      }]
    },
    "Fail": {
      "Type": "Pass",
      "ResultPath": "$.Status",
      "Result": "FAILED",
      "Next": "End"
    },
    "Succeed": {
      "Type": "Pass",
      "ResultPath": "$.Status",
      "Result": "SUCCESS",
      "Next": "End"
    },
    "End": {
      "Type": "Task",
      "ResultPath": null,
      "Resource": "function:SendCloudFormationResponse",
      "End": true
    }
  }
}